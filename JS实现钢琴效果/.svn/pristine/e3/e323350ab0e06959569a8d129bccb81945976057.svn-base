<template>
  <div id="content">
    <div class="rate clearfix">
      <el-breadcrumb separator=" > " class="breadcrumb">
        <el-breadcrumb-item :to="{ path: '/assess/assess' }">当前位置： <b>新能源消纳评估</b></el-breadcrumb-item>
      </el-breadcrumb>
    </div>
    <div class="assess">
      <el-row class="chart">
        <h3 class="header-label">新能源消纳评估</h3>
      <div style="margin-bottom:14px;"> 
        发点年份
           <el-select v-model="value1" placeholder="请选择"  size="small" style="width:150px">
              <el-option
                v-for="item in options1"
                :key="item.value"
                :label="item.label"
                :value="item.value">
              </el-option>
            </el-select>
            <span style="margin-left:30px;">发点预测</span>
           <el-select v-model="value2" placeholder="请选择"  size="small"  style="width:150px">
              <el-option
                v-for="item in options2"
                :key="item.value"
                :label="item.label"
                :value="item.value">
              </el-option>
            </el-select>
            <span style="margin-left:30px;">预测年份</span>
             <el-date-picker  style="width:150px"
                    v-model="value3"
                    align="right"
                    type="year"
                    placeholder="选择年">
          </el-date-picker>
          <div style="position: absolute;right:20px;top:60px;">
             <el-button type="primary" @click="computeds">评估计算</el-button>
             <el-button type="success" @click="history">历史预测查看</el-button>
          </div>
    </div>  
    <el-table
    :data="tableData4"
    style="width: 100%"
    border
    size="small"
    :height="tableheight">
    <el-table-column
      fixed
      prop="xuhao"
      label="序号"
      width="80">
    </el-table-column>
    <el-table-column
      fixed
      prop="date"
      label="评估年份"
      width="190">
    </el-table-column>
    <el-table-column
      prop="name"
      label="负荷预测"
      width="120">
    </el-table-column>
    <el-table-column
      prop="province"
      label="发电预测"
      width="120">
    </el-table-column>
    <el-table-column
      prop="city"
      label="主要参数"
      width="120">
    </el-table-column>
    <el-table-column
      prop="address"
      label="备注"
      >
    </el-table-column>
    <el-table-column
      fixed="right"
      label="操作"
      width="120">
      <template slot-scope="scope">
        <el-button
          @click.native.prevent="deleteRow(scope.$index, tableData4)"
          type="text"
          size="small">
          删除
        </el-button>
      </template>
    </el-table-column>
  </el-table>
      </el-row>
      
    </div>
    
  </div>
</template>
<script>
import { mapState } from 'vuex'
export default {
  name: 'assess',
  components: {},
  data() {
    return {
      tableheight:$(document).height()-310+'px',
       options1: [{
          value: '选项1',
          label: '2019年-指数平滑'
        }, {
          value: '选项2',
          label: '2018年-指数平滑'
        }],
        options2: [{
          value: '选项1',
          label: '2019年-指数平滑'
        }, {
          value: '选项2',
          label: '2018年-指数平滑'
        }],
        value1: '',
        value2: '',
        value3: '',
      delType: 'info',
      delChange: true,
      queryYear: '2018',
      tableData4: [{
          xuhao:1,
          date: '2016-05-03',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
          xuhao:2,
          date: '2016-05-02',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
           xuhao:2,
          date: '2016-05-04',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
           xuhao:2,
          date: '2016-05-01',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
          xuhao:2,
          date: '2016-05-08',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
          xuhao:2,
          date: '2016-05-06',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }, {
          xuhao:2,
          date: '2016-05-07',
          name: '王小虎',
          province: '上海',
          city: '普陀区',
          address: '上海市普陀区金沙江路 1518 弄',
          zip: 200333
        }],
    // 校验规则
     rules: {
        fAdderss: [
          { required: true, //是否必填
           message: '地址不能为空', //规则
           trigger: 'blur' //何事件触发
          },
          //可以设置双重验证标准
          { min: 3, max: 5, message: '长度在 3 到 5 个字符', }
   ]
   },
      pickerOptions: {
        disabledDate(time) {
          return time.getTime() > Date.now()
        }
      },
      // listLoading: true,
      listLoading: false,
      form: {},
      radio: '1',
      type3: '是',
      type4: '是',
      type5: '2019年-指数平滑'
    }
  },
  computed: {
    /* 根据table数据的总页数，来展示 */
    realPageSizes() {
      const pageSizes = [10, 20, 30, 40]
      for (let i = 0; i < pageSizes.length; i++) {
        if (this.tablePageTotal < pageSizes[i]) {
          return pageSizes.slice(0, i + 1)
        }
      }
    },
    ...mapState({
      list: state => state.assess.list,
      form: state => state.assess.detail,
      currentPage: state => state.assess.currentPage,
      totalCount: state => state.assess.totalCount
    })
  },
  created() {
    this.fetchData(1)
  },
  methods: {
    //1.点击按钮弹出弹出框
    computeds() {
       this.$message({
          showClose: true,
          message: '正在计算',
          type: 'success'
        });
      },
    //2.点击历史查看
      history(){
        alert(1122)
      },
    // 3.点击表格弹删除操作
    deleteRow(index, rows) {
        rows.splice(index, 1);
      },
    RuleRequired(message) {
      return [{ required: true, message }]
    },
    fetchData(currPage, pageSize = 10) {
      this.$store.dispatch('GetList_assess', {
        cb: () => {
          this.listLoading = false
        }
      })
    },
    triggerDate() {
      this.$refs.elDatePick.focus()
      this.$refs.triggerDate.blur()
    },
    updateSizeChange(val) {
      this.fetchData(this.currentPage, val)
    },
    updateCurrentChange(val) {
      this.fetchData(val)
    },
    addData() {
      this.$store.dispatch('Add_assess', {
        cb: () => {}
      })
      this.$message({ type: 'success', message: '成功' })
    },
    radioChange(val) {
      this.$store.dispatch('GetDetail_assess', {
        cb: () => {}
      })
      console.log(this.form)
      this.$message({ type: 'success', message: '成功' })
    },
    deleteRep(index) {
			
      this.$confirm('此操作将永久删除该数据, 是否继续', '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        this.$store.dispatch('DeleteData_assess', {
        		 id: index.$index,
           cb: () => {
           	this.$message({ type: 'success', message: '删除成功' })
           }
        })
      })
    }
  }
}
</script>
<style src="../../../styles/public.css"></style>
<style scoped>
.assess{
  background:#8fc0ed;
  border-radius: 10px;
  min-height: 100%;
  padding: 20px;
}
.labelName{
    text-align: right;
    vertical-align: middle;
    float: left;
    font-size: 14px;
    color: #48576a;
    line-height: 1;
    padding: 11px 15px 11px 0;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    width: 90px;
}
.dataQuery{
  margin-left: 40px !important;
}
.ml20{
  margin-left: 20px;
}
.w300{
  width: 300px;
}
.labelVal:hover {
    border-color: #8391a5;
}
.labelVal{
  width: 220px;
    background-color: #fff;
    background-image: none;
    border-radius: 4px;
    border: 1px solid #bfcbd9;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    color: #1f2d3d;
    font-size: 14px;
    height: 36px;
    line-height: 1;
    outline: 0;
    padding: 3px 10px;
    -webkit-transition: border-color .2s cubic-bezier(.645,.045,.355,1);
    transition: border-color .2s cubic-bezier(.645,.045,.355,1);
}
.triggerDate{
  position: relative;
}
.elDatePick{
  position: absolute;
    top: 0;
    opacity: 0;
    left: 90px;
    z-index: -1;
}
.pageContainer{
  padding: 20px 0
}
.queryData{
    border-bottom: 1px solid #d1dbe5;
}
.searchResult{
  padding: 30px 0 0 0;
}
.tableForm{
  border-left:1px solid #CCC;
}
.radioStyle{
  margin: 5px;
}   
</style>
<style>

</style>
